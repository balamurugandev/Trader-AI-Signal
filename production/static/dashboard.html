<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ScalpPro">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Scalp Trader Pro</title>
    <link rel="manifest" href="/static/manifest.json">
    <link rel="apple-touch-icon" href="/static/logo.png">
    <link rel="icon" type="image/png" href="/static/logo.png">
    <link rel="stylesheet" href="/static/style.css?v=2026_center_fix">
    <link rel="stylesheet" href="/static/ticker.css?v=2026_font_fix">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inclusive+Sans:ital,wght@0,400..700;1,400..700&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="logo-container">
                    <img src="/static/logo.png" alt="Scalp Trader Pro Logo" class="logo-image">
                    <h1 class="logo">Scalp Trader Pro</h1>
                </div>
                <div class="header-datetime" id="header-datetime">
                    <span class="datetime-date" id="current-date">--</span>
                    <span class="datetime-time" id="current-time">--:-- --</span>
                </div>
            </div>
            <div class="header-right">
                <a href="/static/logs.html" target="_blank"
                    style="color: #58a6ff; text-decoration: none; margin-right: 15px; font-weight: bold; border: 1px solid #30363d; padding: 5px 10px; border-radius: 6px;">üìú
                    Logs</a>
                <div class="market-status-badge" id="market-status-badge">
                    <span class="status-dot"></span>
                    <span class="status-text" id="market-state-text">CLOSED</span>
                </div>
                <div class="status-badge" id="status-badge">
                    <span class="status-dot"></span>
                    <span class="status-text" id="market-status">CONNECTING...</span>
                </div>
                <!-- Latency Monitor -->
                <div class="latency-badge" id="latency-badge">
                    <span class="latency-dot" id="latency-dot"></span>
                    <span class="latency-text" id="latency-text">0ms</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Ticks</span>
                    <span class="stat-value" id="tick-count">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Candles</span>
                    <span class="stat-value" id="candle-count">0/200</span>
                </div>
            </div>
        </header>

        <!-- Ticker Tape -->
        <div class="ticker-tape">
            <div class="ticker-item" id="ticker-item-nifty">
                <span class="ticker-name">NIFTY 50</span>
                <span class="ticker-value" id="val-nifty">25,048.65</span>
            </div>
            <div class="ticker-item" id="ticker-item-indiavix">
                <span class="ticker-name">INDIA VIX</span>
                <span class="ticker-value" id="val-indiavix">14.19</span>
            </div>
        </div>

        <!-- Main Content (Removed as per user request to prioritize Straddle) -->
        <!-- Price and Indicators panels removed -->

        <!-- ============================================================= -->
        <!-- SCALPING MODULE PANEL (RESTORED) -->
        <!-- ============================================================= -->
        <div class="scalping-section">
            <h2 class="section-title">‚ö° Scalping Module (Future/Options)</h2>

            <div class="scalping-grid">
                <!-- Data Panel -->
                <div class="panel scalping-data-panel">
                    <div class="scalping-stats">
                        <div class="scalp-stat">
                            <span class="scalp-label">Future Price</span>
                            <div style="text-align: right;">
                                <span class="scalp-value" id="future-price">--</span>
                                <!-- Momentum Speedometer with Info -->
                                <div class="momentum-wrapper">
                                    <div class="momentum-info">
                                        <span class="momentum-label">Velocity</span>
                                        <span class="velocity-value" id="velocity-value">-- pts/s</span>
                                    </div>
                                    <div class="momentum-container">
                                        <div class="momentum-bar" id="momentum-bar"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="scalp-stat">
                            <span class="scalp-label">ATM CE <span class="strike-badge" id="ce-strike"></span></span>
                            <span class="scalp-value" id="ce-price">--</span>
                        </div>
                        <div class="scalp-stat">
                            <span class="scalp-label">ATM PE <span class="strike-badge" id="pe-strike"></span></span>
                            <span class="scalp-value" id="pe-price">--</span>
                        </div>
                    </div>

                    <!-- Market Bias Gauge -->
                    <div class="bias-section">
                        <div class="bias-label">
                            Market Bias (Basis)
                            <span class="bias-value-inline" id="basis-value">0.00</span>
                        </div>
                        <div class="bias-gauge">
                            <div class="bias-bar">
                                <div class="bias-fill" id="bias-fill"></div>
                                <div class="bias-center"></div>
                            </div>
                        </div>
                        <div class="bias-labels">
                            <span class="bearish">BEARISH</span>
                            <span class="bullish">BULLISH</span>
                        </div>
                    </div>

                    <!-- Straddle Value -->
                    <div class="straddle-info">
                        <span class="straddle-label">Straddle Price</span>
                        <span class="straddle-value" id="straddle-value">--</span>
                    </div>

                    <!-- Formula Explanation Legend -->
                    <div class="formula-legend">
                        <div class="formula-title">üìê How It Works</div>
                        <div class="formula-item">
                            <span class="formula-name">Synthetic Future</span>
                            <span class="formula-calc">= ATM Strike + CE ‚àí PE</span>
                        </div>
                        <div class="formula-item">
                            <span class="formula-name">Market Bias</span>
                            <span class="formula-calc">= Synthetic Future ‚àí Spot</span>
                        </div>
                        <div class="formula-signals">
                            <span class="signal-green">‚ñ≤ &gt;+5 = Bullish</span>
                            <span class="signal-grey">‚óè ¬±5 = Neutral</span>
                            <span class="signal-red">‚ñº &lt;-5 = Bearish</span>
                        </div>
                    </div>
                </div>

                <!-- Chart Panel -->
                <div class="panel scalping-chart-panel">
                    <div class="panel-header">
                        <h2>üìà Straddle Price Chart</h2>
                        <span class="scalping-status" id="scalping-status">INITIALIZING...</span>
                    </div>
                    <div class="chart-container" id="chart-container-wrapper">
                        <canvas id="straddleChart"></canvas>
                    </div>

                    <!-- Signal Legend (Moved Back Here) -->
                    <div class="signal-legend">
                        <div class="legend-item">
                            <span class="legend-color rising"></span>
                            <span class="legend-text">üü¢ <strong>RISING</strong> = Safe Entry</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color falling"></span>
                            <span class="legend-text">üî¥ <strong>FALLING</strong> = Decay Risk</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color signal"></span>
                            <span class="legend-text">üü©/üü• <strong>SIGNAL</strong> = Entry</span>
                        </div>
                    </div>
                </div>

                <!-- NEW: 3rd Column - Signal Panel -->
                <div class="panel scalping-signal-panel">
                    <div class="panel-header">
                        <h2>üö¶ Signal Engine</h2>
                    </div>

                    <!-- Main Signal Box -->
                    <div class="scalping-signal-box" id="scalping-signal-box">
                        <div class="scalp-signal-icon" id="scalp-signal-icon">‚ö™</div>
                        <div class="scalp-signal-text" id="scalp-signal-text">WAIT</div>
                        <div class="scalp-signal-desc" id="scalp-signal-desc">Waiting for Basis + Straddle trend...
                        </div>

                        <!-- Trade Suggestion -->
                        <div class="trade-suggestion-box">
                            <span class="suggestion-label">RECOMMENDATION</span>
                            <span class="suggestion-value" id="trade-suggestion">WAIT</span>
                        </div>

                        <!-- PCR Badge (Signal Box) -->
                        <div class="pcr-badge-container">
                            <div class="pcr-badge-signal" id="pcr-badge-signal" style="display: none;">
                                PCR: <span id="pcr-value-signal">--</span>
                            </div>
                        </div>
                    </div>

                    <!-- Signal Legend (Moved to Chart Panel) -->
                    <!-- Removed from here -->

                    <!-- Detailed Guide (Compact) -->
                    <div class="scalp-legend-compact">
                        <div class="s-legend-item">
                            <span class="s-dot call">üü¢</span> <span><strong>CALL</strong>: Bull + Rise</span>
                        </div>
                        <div class="s-legend-item">
                            <span class="s-dot put">üî¥</span> <span><strong>PUT</strong>: Bear + Rise</span>
                        </div>
                        <div class="s-legend-item">
                            <span class="s-dot trap">‚ö†Ô∏è</span> <span><strong>TRAP</strong>: OI Clash</span>
                        </div>
                    </div>

                    <!-- History Log -->
                    <div class="signal-history-section">
                        <h3 class="history-title">üìú Last 5 Signals</h3>
                        <div id="signal-history-list" class="signal-history-list">
                            <!-- Items will be added here dynamically -->
                            <div class="history-empty">No signals yet...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ============================================================= -->
            <!-- REAL-TIME NEWS TICKER (Added) -->
            <!-- ============================================================= -->
            <div class="news-container">
                <div class="news-label">MARKET NEWS LIVE: <span id="news-timer"
                        style="font-size: 0.8em; color: #94a3b8; font-weight: normal; margin-left: 8px;">(Finding...)</span>
                </div>
                <div class="ticker-wrapper">
                    <div class="news-content" id="news-ticker">
                        ‚è≥ Fetching latest market updates...
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="footer">
                <span>Powered by Angel One SmartAPI</span>
                <span id="last-update">Last Update: --:--:--</span>
            </footer>
        </div>

        <script src="/static/market_schedule.js?v=2026"></script>
        <script src="/static/app.js?v=feature_news_timer_v3"></script>
</body>

</html>