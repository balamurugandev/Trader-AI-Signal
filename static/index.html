<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIFTY 50 Scalping Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1 class="logo">üìà NIFTY 50</h1>
                <span class="subtitle">Real-Time Scalping Dashboard</span>
                <div class="header-datetime" id="header-datetime">
                    <span class="datetime-date" id="current-date">--</span>
                    <span class="datetime-time" id="current-time">--:-- --</span>
                </div>
            </div>
            <div class="header-right">
                <div class="status-badge" id="status-badge">
                    <span class="status-dot"></span>
                    <span class="status-text" id="market-status">CONNECTING...</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Ticks</span>
                    <span class="stat-value" id="tick-count">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Candles</span>
                    <span class="stat-value" id="candle-count">0/200</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Left Panel: Price & Ticks -->
            <div class="panel price-panel">
                <div class="panel-header">
                    <h2>üí∞ NIFTY 50 Price</h2>
                </div>
                <div class="price-display">
                    <span class="price-symbol">‚Çπ</span>
                    <span class="price-value" id="current-price">--,---.--</span>
                </div>
                <div class="tick-table-container">
                    <h3>Last 10 Ticks</h3>
                    <table class="tick-table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Price</th>
                                <th>Change</th>
                            </tr>
                        </thead>
                        <tbody id="tick-table-body">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Right Panel: Indicators -->
            <div class="panel indicators-panel">
                <div class="panel-header">
                    <h2>üìä Indicators (1-Min)</h2>
                </div>
                <div class="indicator-cards">
                    <div class="indicator-card rsi-card">
                        <div class="indicator-label">RSI (14)</div>
                        <div class="indicator-value" id="rsi-value">--</div>
                        <div class="indicator-status" id="rsi-status">Calculating...</div>
                        <div class="indicator-bar">
                            <div class="indicator-fill" id="rsi-bar"></div>
                            <div class="indicator-markers">
                                <span class="marker" style="left: 30%">30</span>
                                <span class="marker" style="left: 70%">70</span>
                            </div>
                        </div>
                    </div>
                    <div class="indicator-card ema-card">
                        <div class="indicator-label">EMA (50)</div>
                        <div class="indicator-value" id="ema-value">--</div>
                        <div class="indicator-status" id="ema-status">Calculating...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Signal Box (RSI/EMA Based) -->
        <div class="signal-box" id="signal-box">
            <div class="signal-icon" id="signal-icon">‚è≥</div>
            <div class="signal-text" id="signal-text">WAITING</div>
            <div class="signal-description" id="signal-desc">Analyzing market conditions...</div>
        </div>

        <!-- ============================================================= -->
        <!-- SCALPING MODULE PANEL (NEW) -->
        <!-- ============================================================= -->
        <div class="scalping-section">
            <h2 class="section-title">‚ö° Scalping Module (Future/Options)</h2>

            <div class="scalping-grid">
                <!-- Data Panel -->
                <div class="panel scalping-data-panel">
                    <div class="scalping-stats">
                        <div class="scalp-stat">
                            <span class="scalp-label">Future Price</span>
                            <span class="scalp-value" id="future-price">--</span>
                        </div>
                        <div class="scalp-stat">
                            <span class="scalp-label">ATM CE <span class="strike-badge" id="ce-strike"></span></span>
                            <span class="scalp-value" id="ce-price">--</span>
                        </div>
                        <div class="scalp-stat">
                            <span class="scalp-label">ATM PE <span class="strike-badge" id="pe-strike"></span></span>
                            <span class="scalp-value" id="pe-price">--</span>
                        </div>
                    </div>

                    <!-- Market Bias Gauge -->
                    <div class="bias-section">
                        <div class="bias-label">Market Bias (Basis)</div>
                        <div class="bias-gauge">
                            <div class="bias-bar">
                                <div class="bias-fill" id="bias-fill"></div>
                                <div class="bias-center"></div>
                            </div>
                            <div class="bias-value" id="basis-value">0.00</div>
                        </div>
                        <div class="bias-labels">
                            <span class="bearish">BEARISH</span>
                            <span class="bullish">BULLISH</span>
                        </div>
                    </div>

                    <!-- Straddle Value -->
                    <div class="straddle-info">
                        <span class="straddle-label">Straddle Price</span>
                        <span class="straddle-value" id="straddle-value">--</span>
                    </div>

                    <!-- Formula Explanation Legend -->
                    <div class="formula-legend">
                        <div class="formula-title">üìê How It Works</div>
                        <div class="formula-item">
                            <span class="formula-name">Synthetic Future</span>
                            <span class="formula-calc">= ATM Strike + CE ‚àí PE</span>
                        </div>
                        <div class="formula-item">
                            <span class="formula-name">Market Bias</span>
                            <span class="formula-calc">= Synthetic Future ‚àí Spot</span>
                        </div>
                        <div class="formula-signals">
                            <span class="signal-green">‚ñ≤ &gt;+5 = Bullish</span>
                            <span class="signal-grey">‚óè ¬±5 = Neutral</span>
                            <span class="signal-red">‚ñº &lt;-5 = Bearish</span>
                        </div>
                    </div>
                </div>

                <!-- Chart Panel -->
                <div class="panel scalping-chart-panel">
                    <div class="panel-header">
                        <h2>üìà Straddle Price Chart</h2>
                        <span class="scalping-status" id="scalping-status">INITIALIZING...</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="straddleChart"></canvas>
                    </div>

                    <!-- Signal Legend -->
                    <div class="signal-legend">
                        <div class="legend-item">
                            <span class="legend-color rising"></span>
                            <span class="legend-text">üü¢ <strong>RISING</strong> = Momentum (Safe to Enter)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color falling"></span>
                            <span class="legend-text">üî¥ <strong>FALLING</strong> = Decay (Do Not Buy)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color signal"></span>
                            <span class="legend-text">üü©/üü• <strong>SIGNAL</strong> = Confirms Direction</span>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Scalping Signal Box -->
            <div class="scalping-signal-box" id="scalping-signal-box">
                <div class="scalp-signal-icon" id="scalp-signal-icon">‚ö™</div>
                <div class="scalp-signal-text" id="scalp-signal-text">WAIT</div>
                <div class="scalp-signal-desc" id="scalp-signal-desc">Waiting for Basis + Straddle trend...</div>

                <!-- Trade Suggestion -->
                <div class="trade-suggestion-box">
                    <span class="suggestion-label">RECOMMENDATION</span>
                    <span class="suggestion-value" id="trade-suggestion">WAIT</span>
                </div>
            </div>

            <!-- Signal Indicator Legend -->
            <div class="scalp-legend-container">
                <div class="scalp-legend-title">üö¶ Signal Guide</div>
                <div class="scalp-legend-items">
                    <div class="s-legend-item">
                        <span class="s-dot wait">‚ö™</span>
                        <span><strong>WAIT</strong> = No clear trend or decay</span>
                    </div>
                    <div class="s-legend-item">
                        <span class="s-dot call">üü¢</span>
                        <span><strong>BUY CALL</strong> = Bullish Sentiment + Rising Straddle</span>
                    </div>
                    <div class="s-legend-item">
                        <span class="s-dot put">üî¥</span>
                        <span><strong>BUY PUT</strong> = Bearish Sentiment + Rising Straddle</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <span>Powered by Angel One SmartAPI</span>
            <span id="last-update">Last Update: --:--:--</span>
        </footer>
    </div>

    <script src="/static/app.js"></script>
</body>

</html>